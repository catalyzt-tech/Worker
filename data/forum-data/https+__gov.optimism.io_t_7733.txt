{
  "title": "Building a private, on-chain, implementation for RetroPGF",
  "content": "Hello Optimism Collective!\n\nExcited to share plans on a project our team has been working on over the past\nfew weeks.\n\nOur goal is simple - we‚Äôd like to add private, bribery-resistant, on-chain\nvoting to Optimism‚Äôs RetroPGF rounds.\n\n\nWHO ARE WE?\n\nWe‚Äôre the core team working on MACI [https://maci.pse.dev/], an on-chain voting\nplatform which protects privacy and minimizes the risk of collusion and bribery.\nWe‚Äôre an engineering team within PSE [https://pse.dev/en/about], which is\nsupported by the Ethereum Foundation\n\nYou can learn more about MACI in our documentation\n[https://maci.pse.dev/docs/introduction].\n\n\nWHAT ARE WE DOING?\n\nWe‚Äôre building a proof-of-concept RPGF implementation that supports private\non-chain voting for badgeholders of the Citizens House.\n\n * Thanks to folks at Gitcoin & their work on EasyRetroPGF\n   [https://gov.optimism.io/t/easyretropgf-xyz-run-your-own-optimism-style-rpgf-round/7359],\n   we have a purpose-built web app that we‚Äôre forking for our frontend\n * For the ‚Äúbackend‚Äù, we‚Äôre essentially swapping out the SQL database for the\n   MACI smart contracts\n * For badgeholder verification, we‚Äôve built an EAS gatekeeper contract\n   [https://github.com/privacy-scaling-explorations/maci/blob/dev/contracts/contracts/gatekeepers/EASGatekeeper.sol]\n   which ensures only OP badgeholders are eligible to register to vote\n * In line with PSE‚Äôs mission [https://pse.dev/en/about] and inspired by the\n   efforts of EasyRetroPGF, we also open-source all our code in case it‚Äôs\n   beneficial for others\n\nHere‚Äôs the source code:\n\n[https://github.githubassets.com/favicons/favicon.svg] GitHub\n[https://github.com/privacy-scaling-explorations/maci-rpgf/]\n[https://europe1.discourse-cdn.com/bc41dd/optimized/2X/3/3cadb94f3b4ee396552ef832dc5882f1f2fe3120_2_690x345.png]\n\n\nGITHUB - PRIVACY-SCALING-EXPLORATIONS/MACI-RPGF: RPGF WITH MACI\n[https://github.com/privacy-scaling-explorations/maci-rpgf/]\n\nRPGF with MACI. Contribute to privacy-scaling-explorations/maci-rpgf development\nby creating an account on GitHub.\n\n\n\n\nHere‚Äôs where were tracking our progress:\n\n[https://github.githubassets.com/favicons/favicon.svg] GitHub\n[https://github.com/orgs/privacy-scaling-explorations/projects/40/views/1]\n[https://europe1.discourse-cdn.com/bc41dd/optimized/2X/5/55c92a5cafb55dd5ba2c844f704161bfdac81aa6_2_690x362.png]\n\n\nMACI TEAM SPRINT BOARD ‚Ä¢ PRIVACY-SCALING-EXPLORATIONS\n[https://github.com/orgs/privacy-scaling-explorations/projects/40/views/1]\n\nMACI team sprint board\n\n\n\n\n\nWHY ARE WE DOING THIS?\n\nIn many ways, Optimism‚Äôs RPGF rounds are already a massive success. It seems the\nprocess worked in round 3 but - like many of you - we see several areas that can\nbe improved.\n\nFor one, the RPGF process currently depends heavily on the OP foundation to act\nhonestly and competently. In round 3, the community had to trust that:\n\n * Only badgeholders would be able to submit ballots\n * No badgeholder ballots would be censored or manipulated or double-counted\n * The final tally of ballots would be calculated correctly\n\nIf we think about what security properties are critical to a voting, Vitalik\noutlined this in his blog post (Blockchain voting is overrated among uninformed\npeople but underrated among informed people\n[https://vitalik.eth.limo/general/2021/05/25/voting2.html]) as well as anyone\ncould:\n\nAny voting system requires a few crucial security properties in order to be\ntrusted by users:\n\n * Correct execution: the results (tally of votes) must be correct, and the\n   results must be guaranteed by a transparent process (so that everyone is\n   convinced that the results are correct)\n * Censorship resistance: anyone eligible to vote should be able to vote, and it\n   should not be possible to interfere with anyone‚Äôs attempt to vote or to\n   prevent anyone‚Äôs vote from being counted\n * Privacy: no one should be able to tell which candidate anyone voted for, or\n   if they even voted at all\n * Coercion resistance: you should not be able to prove to someone else how you\n   voted, even if you want to\n\nUnfortunately RPGF currently fails in all 4 dimensions. As RPGF continues to\ngrow, we think the need to enforce process integrity will be of upmost\nimportance.\n\nTalking with the folks from the OP foundation about, they‚Äôve mentioned some key\nrequirements for future versions of their RPGF stack:\n\n * Provably correct execution - They‚Äôd want to demonstrate the legitimacy to\n   community in terms of how ballots are submitted and calculated\n * Privacy protection - They want to ensure not just voter privacy, but also\n   vote privacy\n   * Why? While voter privacy alone would offer some valuable protection, if the\n     votes are public, there‚Äôs the chance that data sleuths would be able to\n     deduce the identity of some badgeholders. e.g. say a badgeholder publicly\n     declares a few projects where they have conflicts of interest. If they are\n     the only badgeholder who does NOT vote for those specific projects, anyone\n     would be able view their public ballot and tie it to that specific\n     badgeholder, thus circumventing this supposed privacy protection\n * Collusion resistance - given the money at stake with RPGF, bribery resistance\n   is a key component for any RPGF implementation\n\n\nWHAT SOLUTIONS EXIST?\n\nWe reviewed the options in this private voting report: State of Private Voting\n[https://odyslam.com/blog/state-of-private-voting/]\n\nIt‚Äôs great to see an array of private on-chain voting solutions emerging! As you\ncan see from the report, each has a unique set of features and trade-offs with\ntheir implementation.\n\n\n\nImage 2024-02-28 at 15.00.57\n[https://europe1.discourse-cdn.com/bc41dd/optimized/2X/4/4ccf0456617e88907585beae15e19bbef5ac875d_2_690x344.jpeg]\nImage 2024-02-28 at 15.00.571470√ó734 205 KB\n[https://europe1.discourse-cdn.com/bc41dd/original/2X/4/4ccf0456617e88907585beae15e19bbef5ac875d.jpeg]\n\n\n\n\nWHY DID WE DECIDE ON THIS IMPLEMENTATION?\n\nA number of projects solve some of the above requirements, but again - given the\nmoney at stake with RPGF, we feel that collusion resistance (‚ÄùBriber\nProtection‚Äù, in that report), is an essential component for any RPGF\nimplementation. Currently MACI is the only project with all 3 of these features:\n\n\n\nImage 2024-02-26 at 19.13.39\n[https://europe1.discourse-cdn.com/bc41dd/optimized/2X/b/b8caf735f0f4842ffaafa6270dd3b756a6ce5977_2_690x333.jpeg]\nImage 2024-02-26 at 19.13.391326√ó640 179 KB\n[https://europe1.discourse-cdn.com/bc41dd/original/2X/b/b8caf735f0f4842ffaafa6270dd3b756a6ce5977.jpeg]\n\n\n\nAn RPGF MACI integration has the potential to provide several important security\nguarantees to the RPGF voting process:\n\n 1. Correct execution: With MACI, user registration, voting data and poll logic\n    is stored on-chain. While tallying computation is handled off-chain,\n    ZK-proofs guarantee the correct execution of this logic. In this way, we\n    know the result (tally of votes) will be correct, and the results are\n    guaranteed by a transparent process (anyone can verify that the result is\n    correct) .\n 2. Censorship resistance: With voter verification (via an EAS attestation\n    gatekeeper) and vote submission happening on-chain, there‚Äôs no way for\n    anyone (including the OP foundation) to censor any badgeholder votes.\n 3. Privacy: With MACI‚Äôs receipt-free voting scheme, we‚Äôre able to ensure that\n    results are transparent, but it is impossible for outsiders to verify how\n    any specific user voted (since on-chain votes are encrypted). Vote tallying\n    takes place off-chain but ZKPs are submitted and verified on-chain, which\n    guarantees votes are counted correctly without revealing the individual\n    votes.\n 4. Coercion resistance: With MACI‚Äôs private, receipt-free votes, this makes\n    cheating (like bribery) much harder. User‚Äôs cannot prove which option they\n    voted for, and therefore bribers cannot reliably trust that a user voted for\n    their preferred option. This prevents any bribers from simply reading the\n    transaction data to see which option a user voted for.\n\n\nINPUT/FEEDBACK?\n\nWe‚Äôd love to hear feedback on this plan! The implementation is in-progress but\nwe‚Äôre happy to make potential adjustments based on community input.\n\nIf there are any badgeholders interested in being user-testers for us, please\nlet us know and we‚Äôll get in touch to schedule an user interview once we have a\nworking demo up and running on a testnet! Feel free to comment here, hop into\nthe PSE Discord (#üó≥Ô∏è-maci channel), hit us up on Twitter/X\n[https://twitter.com/zkmaci], or reach out to me directly (sam at ethereum dot\norg).\n\nThanks!\nSam [https://twitter.com/samonchain]",
  "views": 1577,
  "like_count": 48,
  "word_count": 3356,
  "answer": [
    {
      "content": "Hi Sam!\nFirst of all, welcome to the Optimism Collective! :smiley:\n[https://emoji.discourse-cdn.com/twitter/smiley.png?v=12]\n\nI‚Äôm incredibly excited to see more and more teams from the Privacy space joining\nand contributing to improve the governance infrastructure and tooling at\nOptimism and solve for concerns that have been identified through rounds.\nAdditionally, as more members of the Superchain and even ecosystems adjacent or\nthat are part of the Optimism Collective are experimenting with their own\nRetroPGF rounds (which reduces the load for Optimism to shoulder the costs for\nall public goods in the ecosystem) this new build offers them more privacy as\nwell.\n\nFeedback:\n\nFrom the four security guarantees that you mention I believe 4 is the least\nprone to materialize with the current design of the infrastructure/process, and\nwould therefore encourage the prioritization of research to implement\nproof-of-exclusion to this build.\n\nWhile bribery is a threat, Badgeholders currently are unable to successfully\nprove to someone that they voted in a specific direction; to do so, they would\nneed to get their signed ballot from the Agora team or the Foundation, which\nwould require a much more complex set up with multiple stakeholders across\ndifferent groups with different interests. However, we have seen the importance\nof being able to verify that Badgeholders are not voting for their own\nprojects/conflicts of interest.\n\nBased on comments from our last Badgeholder meetup, the sentiment was that there\nis currently a healthy degree of trust in the Optimism Foundation as an\noperator, and while moving for a decentralized process is in the interest of the\nCollective as a whole (aligned with the goal to decentralize governance) it\nseems the more pressing matter is to solve for CoI‚Äôs verification.\n\nAdditionally, including new rules of enforcement for CoIs seems to be aligned\nwith the incentives that are now in place\n[https://gov.optimism.io/t/retro-citizen-rewards-retro-funding-3/7758] for\nBadgeholders to report their CoI publicly, which means that the build will serve\nto double down on this requirement while preserving the integrity of the process\n(internally and externally).\n\nEAS would probably be the best tool to register this data on chain with a\nspecific schema, where if people need to update their CoI‚Äôs (as happened in the\nlast round) MACI could just look at the latest attestation to generate the proof\nwhen validating the signed ballot. Given that the MACI team is already\nleveraging EAS to gate voting, it may be a low hanging fruit to explore\nincluding it into another circuit (maybe).\n\nQuestions:\n\n 1. On ‚Äúcorrect execution‚Äù would this build enable more complex calculations for\n    distributions beyond ‚Äútallying the votes‚Äù? Or would what MACI enable is the\n    building of a DataFrame as described here\n    [https://plaid-cement-e44.notion.site/EZKL-RetroPGF-6bd50495a467468395b25ef103f53d3c]?\n    Would an additional proof be required to ensure the right calculation was\n    carried out, or is this proof of calculation contained in MACI?\n\nAs a Badgeholder, I‚Äôd also be interested in being a user-tester for the demo\nonce it‚Äôs live. :sparkles:\n[https://emoji.discourse-cdn.com/twitter/sparkles.png?v=12]",
      "created_at": "2024-03-12T07:14:38.469Z",
      "trust_level": 3,
      "username": "LauNaMu",
      "admin": false,
      "moderator": false,
      "staff": false,
      "like_count": 5
    },
    {
      "content": "Hey folks! For those interested in kicking the tires on this stack, we just\ndeployed a testnet round that‚Äôs ready for you to play around with. See\ninstructions here:\n\ntwitter.com [https://twitter.com/zkMACI/status/1775245089675383103?s=20]\n[https://europe1.discourse-cdn.com/bc41dd/original/2X/7/7ce3ef657edcdf9ab08e71fa542e9c1c48e3f0b4.jpeg]\n\nMACI [https://twitter.com/zkMACI/status/1775245089675383103?s=20]\n\n@zkMACI [https://twitter.com/zkMACI/status/1775245089675383103?s=20]\nWe've deployed a testnet MACI-RPGF round (on OP Sepolia) which you can now demo!\nInstructions here: hackmd.io/@samajammin/ma‚Ä¶\n[https://hackmd.io/@samajammin/maci-rpgf-demo] Feedback welcome!\nx.com/samonchain/sta‚Ä¶\n[https://twitter.com/samonchain/status/1762947924797829363]\n\nsamrichards.eth @samonchain\n\n[https://twitter.com/samonchain/status/1762947924797829363]\nNew proposal on @OptimismGov - we're building an RPGF stack integrated with\n@zkMACI to bring private, bribery-resistant, on-chain voting to Optimism‚Äôs\nRetroPGF rounds We'd love your feedback! https://t.co/jtpWlYknb9\n7:33 PM - 2 Apr 2024\n[https://twitter.com/zkMACI/status/1775245089675383103?s=20] 6 2\n\n",
      "created_at": "2024-04-02T20:31:08.173Z",
      "trust_level": 1,
      "username": "samajammin",
      "admin": false,
      "moderator": false,
      "staff": false,
      "like_count": 4
    },
    {
      "content": "Hey Sam, I like what you guys are working on\nI am quite interested in giving feedback, testing it and helping where I can.\nOne questions: Could this implementation ensure that Badehgolders don‚Äôt vote for\ntheir own projects? (without relying on the foundation to do the sampling?)\nOn the other hand, I have some ideas of running a mini-rpgf round ourselves at\nCryptoversidad, we‚Äôd like to see if we could implement a prototype of this idea‚Ä¶\nNice work,",
      "created_at": "2024-03-05T18:07:32.810Z",
      "trust_level": 4,
      "username": "dmars300",
      "admin": false,
      "moderator": true,
      "staff": true,
      "like_count": 3
    },
    {
      "content": "Thanks for sharing this @samajammin [/u/samajammin]!\n\nWhile I agree with some the reasoning behind protecting voter privacy in\nRetroPGF, I also believe we should be baking in accountability into round\ndesigns. With great power comes great accountability.\n\n\n[https://dub1.discourse-cdn.com/bc41dd/user_avatar/gov.optimism.io/samajammin/48/8242_2.png]\nsamajammin:\n>  * Privacy: no one should be able to tell which candidate anyone voted for, or\n>    if they even voted at all\n>  * Coercion resistance: you should not be able to prove to someone else how\n>    you voted, even if you want to\n\nDoes privacy/ coercion resistance intersect with accountability in any way? I\npersonally feel this can be gamed by tight knight groups that have long term\noverlap as they capture influence within DAOs and funding mechanisms. Does more\ntransparency allow for community scrutiny to ensure correct execution and\ncensorship resistance?\n\nHypothetical scenario: Projects A, B, C, D have overlapping badgeholder\ncontributors and those projects compete against projects E, F, G, H (which may\nor may not have badgeholders as contributors).\n\nHow can this implementation ensure that:\n\n 1. Badgeholders in projects A-D allocate funding based on impact without\n    favoring their overlapping relationships?\n\n 2. Badgeholders in projects A-D don‚Äôt cast votes that drag down the median\n    result for projects E-H?\n\n\n[https://dub1.discourse-cdn.com/bc41dd/user_avatar/gov.optimism.io/samajammin/48/8242_2.png]\nsamajammin:\n\n> Coercion resistance: you should not be able to prove to someone else how you\n> voted, even if you want to\n\nSome badgeholders vote on behalf of their team/ project/ community. How can\nthose contributors ensure that the badgeholder will cast votes as determined by\nthe group and not change them based on their own measurement of impact?\n\n\n[https://dub1.discourse-cdn.com/bc41dd/user_avatar/gov.optimism.io/samajammin/48/8242_2.png]\nsamajammin:\n\n> For one, the RPGF process currently depends heavily on the OP foundation to\n> act honestly and competently. In round 3, the community had to trust that:\n> \n>  * Only badgeholders would be able to submit ballots\n>  * No badgeholder ballots would be censored or manipulated or double-counted\n>  * The final tally of ballots would be calculated correctly\n\nDoes more transparency in this process allow for the community to take an active\nrole in reviewing fair and honest participation from all stakeholders?",
      "created_at": "2024-03-09T11:52:35.920Z",
      "trust_level": 2,
      "username": "Carlosjmelgar",
      "admin": false,
      "moderator": false,
      "staff": false,
      "like_count": 3
    },
    {
      "content": "Hi everyone! Reviving this thread to give you few updates :slight_smile:\n[https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=12]\n\n * The MACI team published a technical solution\n   [https://github.com/privacy-scaling-explorations/maci/discussions/1440] to\n   privately guarantee no conflict of interest. Will this be interesting to\n   pursue? Who might be a good point of contact to discuss implementation\n   details and tradeoffs.\n * We‚Äôre also releasing a new version of MACI-RPGF with revamped UX/UI! Would\n   anyone here be interested in playing with the prototype and providing direct\n   feedback? Next are the guided-recorded demos:\n\n * Voter sign up [https://www.loom.com/share/c7260aa69b01426993823540301615e2]\n * Project sign up [https://www.loom.com/share/751d7af3f2104f4a975891553eb5c044]\n * Admin demo [https://www.loom.com/share/034dd3109a3e4d37be4a843814dca925]\n\nNote: I‚Äôm Andy, Technical Product Manager part of the MACI/PSE team\n:slight_smile: [https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=12]\n:wave: [https://emoji.discourse-cdn.com/twitter/wave.png?v=12] wish to be more\nactive and involved here!",
      "created_at": "2024-06-25T21:19:06.133Z",
      "trust_level": 2,
      "username": "andyguzman",
      "admin": false,
      "moderator": false,
      "staff": false,
      "like_count": 3
    }
  ],
  "created_at": "2024-02-28T21:05:37.737Z"
}